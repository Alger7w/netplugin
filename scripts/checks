#!/bin/bash

#performs basic dev and build environment checks

echo "Checking GOBIN is set..."
if [ $GOBIN == "" ]; then
    echo "GOBIN needs to be set to proceed. Usually it's GOPATH/bin"
    exit 1
fi

echo "Checking Go version..."
ver=$(go version | awk '{print $3}')
if [[ $ver < "go1.4" ]]; then
    echo "Go version check failed. Expected 1.4 but found $ver"
    exit 1
fi

echo "Checking gofmt..."
fmtRes=$(gofmt -l ./)
if [ -n "${fmtRes}" ]; then
    echo -e "gofmt checking failed:\n${fmtRes}"
    exit 1
fi

echo "All checks passed!!"
